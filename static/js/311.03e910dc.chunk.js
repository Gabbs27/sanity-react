"use strict";(self.webpackChunksanity_react=self.webpackChunksanity_react||[]).push([[311],{311:function(t,e,n){n.r(e),n.d(e,{encodeIntoResult:function(){return _},stegaEncodeSourceMap:function(){return Z},stegaEncodeSourceMap$1:function(){return I}});var r=n(3433),o=n(7762),a=n(4506),i=n(1413),c=n(9439),u=n(6948),s=/_key\s*==\s*['"](.*)['"]/;function l(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce((function(t,e,n){var r=typeof e;if("number"===r)return"".concat(t,"[").concat(e,"]");if("string"===r)return"".concat(t).concat(0===n?"":".").concat(e);if(function(t){return"string"==typeof t?s.test(t.trim()):"object"==typeof t&&"_key"in t}(e)&&e._key)return"".concat(t,'[_key=="').concat(e._key,'"]');if(Array.isArray(e)){var o=(0,c.Z)(e,2),a=o[0],i=o[1];return"".concat(t,"[").concat(a,":").concat(i,"]")}throw new Error("Unsupported path segment `".concat(JSON.stringify(e),"`"))}),"")}var f={"\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","'":"\\'","\\":"\\\\"},p={"\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t","\\'":"'","\\\\":"\\"};function d(t){for(var e,n=[],r=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;null!==(e=r.exec(t));)if(void 0===e[1])if(void 0===e[2])if(void 0===e[3]);else{var o=e[3].replace(/\\(\\')/g,(function(t){return p[t]}));n.push({_key:o,_index:-1})}else n.push(parseInt(e[2],10));else{var a=e[1].replace(/\\(\\|f|n|r|t|')/g,(function(t){return p[t]}));n.push(a)}return n}function h(t){return t.map((function(t){if("string"==typeof t||"number"==typeof t)return t;if(""!==t._key)return{_key:t._key};if(-1!==t._index)return t._index;throw new Error("invalid segment:".concat(JSON.stringify(t)))}))}function v(t,e){if(null!==e&&void 0!==e&&e.mappings){var n=function(t){return"$".concat(t.map((function(t){return"string"==typeof t?"['".concat(t.replace(/[\f\n\r\t'\\]/g,(function(t){return f[t]})),"']"):"number"==typeof t?"[".concat(t,"]"):""!==t._key?"[?(@._key=='".concat(t._key.replace(/['\\]/g,(function(t){return f[t]})),"')]"):"[".concat(t._index,"]")})).join(""))}(t.map((function(t){if("string"==typeof t||"number"==typeof t)return t;if(-1!==t._index)return t._index;throw new Error("invalid segment:".concat(JSON.stringify(t)))})));if(void 0!==e.mappings[n])return{mapping:e.mappings[n],matchedPath:n,pathSuffix:""};var r=Object.entries(e.mappings).filter((function(t){var e=(0,c.Z)(t,1)[0];return n.startsWith(e)})).sort((function(t,e){var n=(0,c.Z)(t,1)[0];return(0,c.Z)(e,1)[0].length-n.length}));if(0!=r.length){var o=(0,c.Z)(r[0],2),a=o[0];return{mapping:o[1],matchedPath:a,pathSuffix:n.substring(a.length)}}}}function g(t){return null!==t&&Array.isArray(t)}function y(t){return"object"==typeof t&&null!==t}function m(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(g(t))return t.map((function(t,r){if(y(t)){var o=t._key;if("string"==typeof o)return m(t,e,n.concat({_key:o,_index:r}))}return m(t,e,n.concat(r))}));if(y(t)){if("block"===t._type||"span"===t._type){var r=(0,i.Z)({},t);return"block"===t._type?r.children=m(t.children,e,n.concat("children")):"span"===t._type&&(r.text=m(t.text,e,n.concat("text"))),r}return Object.fromEntries(Object.entries(t).map((function(t){var r=(0,c.Z)(t,2),o=r[0];return[o,m(r[1],e,n.concat(o))]})))}return e(t,n)}function _(t,e,n){return m(t,(function(t,r){if("string"!=typeof t)return t;var o=v(r,e);if(!o)return t;var a=o.mapping,i=o.matchedPath;if("value"!==a.type||"documentValue"!==a.source.type)return t;var c=e.documents[a.source.document],u=e.paths[a.source.path],s=d(i),l=d(u).concat(r.slice(s.length));return n({sourcePath:l,sourceDocument:c,resultPath:r,value:t})}))}var k=".",b="".concat("drafts").concat(k),w="".concat("versions").concat(k);function U(t){return t.startsWith(b)}function x(t){return t.startsWith(w)}function E(t){var e=t.baseUrl,n=t.workspace,r=void 0===n?"default":n,o=t.tool,i=void 0===o?"default":o,c=t.id,u=t.type,s=t.path,f=t.projectId,p=t.dataset;if(!e)throw new Error("baseUrl is required");if(!s)throw new Error("path is required");if(!c)throw new Error("id is required");if("/"!==e&&e.endsWith("/"))throw new Error("baseUrl must not end with a slash");var d="default"===r?void 0:r,v="default"===i?void 0:i,g=function(t){return x(t)?t.split(k).slice(2).join(k):U(t)?t.slice(b.length):t}(c),y=Array.isArray(s)?l(h(s)):s,m=new URLSearchParams({baseUrl:e,id:g,type:u,path:y});if(d&&m.set("workspace",d),v&&m.set("tool",v),f&&m.set("projectId",f),p&&m.set("dataset",p),function(t){return!U(t)&&!x(t)}(c))m.set("perspective","published");else if(x(c)){var _=function(t){if(x(t)){var e=t.split(k),n=(0,a.Z)(e),r=(n[0],n[1]);return n.slice(2),r}}(c);m.set("perspective",_)}var w=["/"===e?"":e];d&&w.push(d);var E=["mode=presentation","id=".concat(g),"type=".concat(u),"path=".concat(encodeURIComponent(y))];return v&&E.push("tool=".concat(v)),w.push("intent","edit","".concat(E.join(";"),"?").concat(m)),w.join("/")}var P=function(t){var e,n=t.sourcePath,r=t.resultPath,o=t.value;if(/^\d{4}-\d{2}-\d{2}/.test(e=o)&&Date.parse(e)||function(t){try{new URL(t,t.startsWith("/")?"https://acme.com":void 0)}catch(e){return!1}return!0}(o))return!1;var a=n.at(-1);return!("slug"===n.at(-2)&&"current"===a||"string"==typeof a&&(a.startsWith("_")||a.endsWith("Id"))||n.some((function(t){return"meta"===t||"metadata"===t||"openGraph"===t||"seo"===t}))||j(n)||j(r)||"string"==typeof a&&S.has(a))},S=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","textTheme","unit","url","username","variant","website"]);function j(t){return t.some((function(t){return"string"==typeof t&&null!==t.match(/type/i)}))}function Z(t,e,n){var a,c=n.filter,l=n.logger;if(!n.enabled){var f,p="config.enabled must be true, don't call this function otherwise";throw null!==l&&void 0!==l&&null!==(f=l.error)&&void 0!==f&&f.call(l,"[@sanity/client]: ".concat(p),{result:t,resultSourceMap:e,config:n}),new TypeError(p)}if(!e)return null!==l&&void 0!==l&&null!==(a=l.error)&&void 0!==a&&a.call(l,"[@sanity/client]: Missing Content Source Map from response body",{result:t,resultSourceMap:e,config:n}),t;if(!n.studioUrl){var d,h="config.studioUrl must be defined";throw null!==l&&void 0!==l&&null!==(d=l.error)&&void 0!==d&&d.call(l,"[@sanity/client]: ".concat(h),{result:t,resultSourceMap:e,config:n}),new TypeError(h)}var v={encoded:[],skipped:[]},g=_(t,e,(function(t){var e=t.sourcePath,r=t.sourceDocument,o=t.resultPath,a=t.value;if(!1===("function"==typeof c?c({sourcePath:e,resultPath:o,filterDefault:P,sourceDocument:r,value:a}):P({sourcePath:e,resultPath:o,value:a})))return l&&v.skipped.push({path:A(e),value:"".concat(a.slice(0,20)).concat(a.length>20?"...":""),length:a.length}),a;l&&v.encoded.push({path:A(e),value:"".concat(a.slice(0,20)).concat(a.length>20?"...":""),length:a.length});var s=function(t){var e="string"==typeof t?t:t.baseUrl;return"/"!==e&&(e=e.replace(/\/$/,"")),"string"==typeof t?{baseUrl:e}:(0,i.Z)((0,i.Z)({},t),{},{baseUrl:e})}("function"==typeof n.studioUrl?n.studioUrl(r):n.studioUrl),f=s.baseUrl,p=s.workspace,d=s.tool;if(!f)return a;var h=r._id,g=r._type,y=r._projectId,m=r._dataset;return(0,u.C)(a,{origin:"sanity.io",href:E((0,i.Z)({baseUrl:f,workspace:p,tool:d,id:h,type:g,path:e},!n.omitCrossDatasetReferenceData&&{dataset:m,projectId:y}))},!1)}));if(l){var y,m,k,b,w,U=v.skipped.length,x=v.encoded.length;if((U||x)&&(null!==(y=(null===l||void 0===l?void 0:l.groupCollapsed)||l.log)&&void 0!==y&&y("[@sanity/client]: Encoding source map into result"),null!==(m=l.log)&&void 0!==m&&m.call(l,"[@sanity/client]: Paths encoded: ".concat(v.encoded.length,", skipped: ").concat(v.skipped.length))),v.encoded.length>0&&(null!==l&&void 0!==l&&null!==(k=l.log)&&void 0!==k&&k.call(l,"[@sanity/client]: Table of encoded paths"),null!==(b=(null===l||void 0===l?void 0:l.table)||l.log)&&void 0!==b&&b(v.encoded)),v.skipped.length>0){var S,j,Z=new Set,I=(0,o.Z)(v.skipped);try{for(I.s();!(j=I.n()).done;){var M=j.value.path;Z.add(M.replace(s,"0").replace(/\[\d+\]/g,"[]"))}}catch(C){I.e(C)}finally{I.f()}null===l||void 0===l||null===(S=l.log)||void 0===S||S.call(l,"[@sanity/client]: List of skipped paths",(0,r.Z)(Z.values()))}(U||x)&&(null===l||void 0===l||null===(w=l.groupEnd)||void 0===w||w.call(l))}return g}function A(t){return l(h(t))}var I=Object.freeze({__proto__:null,stegaEncodeSourceMap:Z})}}]);
//# sourceMappingURL=311.03e910dc.chunk.js.map